<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Our Private World üíå</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;1,700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --rose:       #e8526a;
      --rose-dim:   rgba(232,82,106,0.12);
      --bg:         #fafafa;
      --surface:    #ffffff;
      --border:     #f0eaea;
      --text:       #1e1012;
      --text-2:     #7c6870;
      --text-3:     #c2b0b4;
      --dot-off:    #e8e0e1;
      --key-bg:     #f7f3f4;
      --key-border: #ede6e7;
      --shadow:     rgba(200,140,150,0.15);
      --glow-a:     #fce7ec;
      --glow-b:     #ffd6dc;
    }
    [data-night] {
      --bg:         #0c0708;
      --surface:    #180c0e;
      --border:     #2a1518;
      --text:       #f0e4e7;
      --text-2:     #9a8085;
      --text-3:     #3d2528;
      --dot-off:    #2a1518;
      --key-bg:     #1a0e10;
      --key-border: #2a1518;
      --shadow:     rgba(232,82,106,0.08);
      --glow-a:     #5a0f1a;
      --glow-b:     #3a0810;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      width: 100%; height: 100%;
      font-family: 'DM Sans', sans-serif;
      background: var(--bg); color: var(--text);
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
      transition: background 0.45s, color 0.45s;
    }

    .blob { position: fixed; border-radius: 50%; filter: blur(90px); opacity: 0.5; pointer-events: none; z-index: 0; }
    .blob-a { width: 340px; height: 340px; background: var(--glow-a); top: -100px; right: -80px; }
    .blob-b { width: 260px; height: 260px; background: var(--glow-b); bottom: -60px; left: -60px; }

    /* ‚ïê‚ïê LOCK OVERLAY ‚ïê‚ïê */
    #overlay {
      position: fixed; inset: 0; z-index: 900;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      background: var(--bg); padding: 24px 20px;
      transition: opacity 0.6s ease, transform 0.6s cubic-bezier(0.4,0,0.2,1);
    }
    #overlay.bye { opacity: 0; transform: translateY(-100%); pointer-events: none; }
    #theme-pill-lock {
      position: absolute; top: 20px; right: 20px;
      width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;
      background: var(--surface); border: 1px solid var(--border); border-radius: 50%;
      cursor: pointer; box-shadow: 0 2px 12px var(--shadow);
      transition: background 0.4s, transform 0.3s; user-select: none; font-size: 18px;
    }
    #theme-pill-lock:hover { transform: rotate(20deg) scale(1.08); }
    #lock-card {
      width: 100%; max-width: 340px;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 28px; box-shadow: 0 20px 56px var(--shadow);
      padding: 34px 24px 28px; display: flex; flex-direction: column; align-items: center;
    }
    .lock-icon-wrap { width: 54px; height: 54px; border-radius: 50%; background: var(--rose-dim); display: flex; align-items: center; justify-content: center; margin-bottom: 18px; }
    .lock-heading { font-family: 'Playfair Display', serif; font-size: 1.65rem; font-weight: 700; text-align: center; color: var(--text); margin-bottom: 5px; }
    .lock-hint    { font-size: 12px; font-weight: 500; color: var(--text-2); text-align: center; margin-bottom: 2px; }
    .lock-format  { font-size: 10px; letter-spacing: 0.22em; text-transform: uppercase; color: var(--text-3); text-align: center; margin-bottom: 26px; }
    .dots-row { display: flex; gap: 14px; justify-content: center; margin-bottom: 26px; }
    .dot { width: 12px; height: 12px; border-radius: 50%; background: var(--dot-off); transition: background 0.22s, transform 0.22s, box-shadow 0.22s; }
    .dot.on { background: var(--rose); transform: scale(1.3); box-shadow: 0 0 10px rgba(232,82,106,0.4); }
    .numpad { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; width: 100%; }
    .key {
      aspect-ratio: 1/0.72; display: flex; align-items: center; justify-content: center;
      background: var(--key-bg); border: 1px solid var(--key-border); border-radius: 14px;
      font-size: 1.15rem; font-weight: 500; color: var(--text); cursor: pointer;
      transition: all 0.16s; user-select: none;
    }
    .key:hover  { background: var(--rose-dim); border-color: var(--rose); color: var(--rose); }
    .key:active { transform: scale(0.92); }
    .key.del    { color: var(--rose); }
    .key.empty  { visibility: hidden; pointer-events: none; }
    #err { font-size: 12px; color: var(--rose); margin-top: 16px; opacity: 0; transition: opacity 0.3s; min-height: 16px; text-align: center; }

    /* ‚ïê‚ïê TOP ACTION BAR ‚ïê‚ïê */
    #side-actions {
      display: flex; flex-direction: row; align-items: center; gap: 10px;
      margin-bottom: 16px; opacity: 0; pointer-events: none;
      transition: opacity 0.5s ease 0.3s; justify-content: flex-end;
    }
    #side-actions.visible { opacity: 1; pointer-events: all; }
    .side-btn {
      width: 40px; height: 40px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      background: var(--surface); border: 1px solid var(--border);
      cursor: pointer; box-shadow: 0 2px 12px var(--shadow);
      color: var(--text-2); font-size: 17px;
      transition: background 0.22s, border-color 0.22s, color 0.22s, transform 0.18s, box-shadow 0.22s;
      user-select: none;
    }
    .side-btn:hover { background: var(--rose); border-color: var(--rose); color: #fff; transform: translateY(-1px); box-shadow: 0 6px 20px rgba(232,82,106,0.28); }
    .side-btn:active { transform: scale(0.96); }
    body.is-fullscreen #btn-fullscreen { background: var(--rose-dim); border-color: var(--rose); color: var(--rose); }

    /* ‚ïê‚ïê MAIN ‚ïê‚ïê */
    #main { position: relative; z-index: 10; max-width: 1160px; margin: 0 auto; padding: 80px 24px 60px; }
    .reveal { opacity: 0; transform: translateY(22px); transition: opacity 0.75s ease, transform 0.75s ease; }
    .reveal.active { opacity: 1; transform: none; }
    .badge { display: inline-block; padding: 4px 14px; border-radius: 99px; background: var(--rose-dim); color: var(--rose); font-size: 10px; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; margin-bottom: 20px; }
    .hero-title { font-family: 'Playfair Display', serif; font-size: clamp(2.8rem,8vw,5.5rem); line-height: 1.08; color: var(--text); margin-bottom: 48px; }
    .hero-title em { color: var(--rose); font-style: italic; }

    /* ‚ïê‚ïê FILTER BAR ‚ïê‚ïê */
    #filter-bar {
      display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
      margin-bottom: 48px; padding: 14px 20px;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 18px; box-shadow: 0 4px 20px var(--shadow);
    }
    .filter-group { display: flex; align-items: center; gap: 8px; }
    .filter-group-label { font-size: 10px; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; color: var(--text-3); display: flex; align-items: center; gap: 5px; flex-shrink: 0; white-space: nowrap; }
    .f-wrap { position: relative; display: inline-flex; align-items: center; }
    .f-select { appearance: none; -webkit-appearance: none; padding: 8px 30px 8px 14px; border-radius: 99px; border: 1px solid var(--border); background: var(--key-bg); color: var(--text-2); font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500; cursor: pointer; outline: none; min-width: 130px; transition: all 0.2s; }
    .f-select:hover, .f-select:focus { border-color: var(--rose); color: var(--rose); }
    .f-select.active { background: var(--rose); border-color: var(--rose); color: #fff; font-weight: 600; }
    .f-select option { background: var(--surface); color: var(--text); }
    .f-chevron { position: absolute; right: 10px; pointer-events: none; width: 12px; height: 12px; color: var(--text-3); flex-shrink: 0; }
    .f-select.active ~ .f-chevron { color: rgba(255,255,255,0.8); }
    .filter-divider { width: 1px; height: 22px; background: var(--border); flex-shrink: 0; }
    #filter-count { font-size: 11px; color: var(--text-3); margin-left: 4px; white-space: nowrap; }
    #filter-count b { color: var(--rose); }
    #filter-reset { padding: 7px 14px; border-radius: 99px; border: 1px solid var(--border); background: transparent; font-family: 'DM Sans', sans-serif; font-size: 11px; font-weight: 500; color: var(--text-3); cursor: pointer; transition: all 0.2s; display: none; align-items: center; gap: 5px; }
    #filter-reset.visible { display: flex; }
    #filter-reset:hover { border-color: var(--rose); color: var(--rose); background: var(--rose-dim); }

    /* ‚ïê‚ïê GALLERY ‚ïê‚ïê */
    #gallery { display: grid; grid-template-columns: repeat(12,1fr); gap: 20px; }
    @media (max-width: 700px) {
      #gallery { grid-template-columns: 1fr; }
      .g-item { grid-column: span 1 !important; margin-top: 0 !important; }
    }
    .g-img-wrap { position: relative; overflow: hidden; border-radius: 22px; }
    .g-img-inner { position: relative; width: 100%; }
    .g-img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.65s cubic-bezier(0.165,0.84,0.44,1); }
    .g-item:hover .g-img { transform: scale(1.06); }
    .g-hover-layer { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.5), transparent 55%); opacity: 0; transition: opacity 0.35s; display: flex; align-items: flex-end; padding: 20px; }
    .g-item:hover .g-hover-layer { opacity: 1; }
    .g-hover-layer span { color: #fff; font-size: 10px; font-weight: 600; letter-spacing: 0.18em; text-transform: uppercase; }
    .g-strip { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; pointer-events: none; }
    .g-dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(255,255,255,0.45); transition: background 0.2s, transform 0.2s; }
    .g-dot.cur { background: #fff; transform: scale(1.3); }
    .g-nav { position: absolute; top: 50%; transform: translateY(-50%); width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.88); border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; transition: opacity 0.2s; color: #1e1012; z-index: 5; backdrop-filter: blur(4px); }
    .g-nav.prev { left: 8px; }
    .g-nav.next { right: 8px; }
    .g-img-wrap:hover .g-nav { opacity: 1; }
    .img-count-badge { position: absolute; top: 12px; right: 12px; background: rgba(0,0,0,0.55); color: #fff; font-size: 10px; font-weight: 700; padding: 3px 9px; border-radius: 99px; display: flex; align-items: center; gap: 4px; backdrop-filter: blur(4px); pointer-events: none; }

    /* ‚ïê‚ïê CAPTION + DESCRIPTION ‚ïê‚ïê */
    .g-caption { margin-top: 14px; }
    .g-title { font-family: 'Playfair Display', serif; font-size: 1.2rem; color: var(--text); }
    .g-loc   { font-size: 10px; color: var(--text-2); letter-spacing: 0.14em; margin-top: 3px; text-transform: uppercase; }
    .g-date  { font-size: 10px; color: var(--text-3); letter-spacing: 0.1em; margin-top: 2px; }

    /* ‚ú® Description note */
    .g-desc {
      margin-top: 10px;
      font-size: 12px;
      line-height: 1.7;
      color: var(--text-2);
      font-style: italic;
      border-left: 2px solid rgba(232,82,106,0.3);
      padding-left: 10px;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      transition: color 0.3s;
    }
    .g-desc.expanded {
      -webkit-line-clamp: unset;
      display: block;
    }
    .g-item:hover .g-desc { color: var(--text); }

    .g-desc-toggle {
      display: none;
      margin-top: 6px;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--rose);
      cursor: pointer;
      background: none;
      border: none;
      padding: 0;
      font-family: 'DM Sans', sans-serif;
      transition: opacity 0.2s;
    }
    .g-desc-toggle:hover { opacity: 0.7; }

    .g-item { transition: opacity 0.35s, transform 0.35s; }
    .g-item.filtered-out { opacity: 0; pointer-events: none; transform: scale(0.97); height: 0; overflow: hidden; margin: 0 !important; padding: 0; }

    .timeline-header { grid-column: 1/-1; display: flex; align-items: center; gap: 16px; margin-top: 20px; margin-bottom: 4px; }
    .timeline-header.filtered-out { display: none !important; }
    .tl-dot  { width: 10px; height: 10px; border-radius: 50%; background: var(--rose); flex-shrink: 0; }
    .tl-info { flex: 1; }
    .tl-date { font-size: 11px; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; color: var(--rose); }
    .tl-loc  { font-size: 10px; color: var(--text-3); letter-spacing: 0.12em; text-transform: uppercase; margin-top: 1px; }
    .tl-line { flex: 1; height: 1px; background: var(--border); }
    #gallery-loader { grid-column:1/-1; display:flex; align-items:center; justify-content:center; gap:12px; padding:60px 0; color:var(--text-3); font-size:13px; }
    .loader-spin { width:20px; height:20px; border-radius:50%; border:2px solid var(--border); border-top-color:var(--rose); animation:spin 0.8s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }
    #no-results { grid-column:1/-1; text-align:center; padding:80px 0; color:var(--text-3); display:none; font-size:14px; }
    #no-results.show { display:block; }
    footer { border-top:1px solid var(--border); margin-top:90px; padding:50px 0; text-align:center; }
    footer h3 { font-family:'Playfair Display',serif; font-size:1.6rem; color:var(--text); margin-bottom:10px; }
    footer p  { font-size:10px; letter-spacing:0.38em; color:var(--text-3); text-transform:uppercase; }

    /* ‚ïê‚ïê LIGHTBOX ‚ïê‚ïê */
    #lightbox { position:fixed; inset:0; z-index:999; display:none; align-items:center; justify-content:center; flex-direction:column; background:rgba(250,248,248,0.88); backdrop-filter:blur(20px); overflow:hidden; touch-action:none; }
    [data-night] #lightbox { background:rgba(8,4,5,0.9); }
    #lightbox.open { display:flex; }
    #lb-zoom-area { flex:1; width:100%; display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative; touch-action:none; }
    #lb-img { max-height:78vh; max-width:90vw; border-radius:18px; box-shadow:0 30px 80px rgba(0,0,0,0.18); opacity:0; transform-origin:center center; transition:opacity 0.45s,border-radius 0.3s; user-select:none; pointer-events:none; will-change:transform; }
    #lb-img.on { opacity:1; }
    #lb-caption { flex-shrink:0; padding:14px 24px 20px; text-align:center; opacity:0; transform:translateY(8px); transition:all 0.4s 0.1s; max-width:560px; width:100%; }
    #lb-caption.on { opacity:1; transform:none; }
    #lb-caption.hidden-cap { opacity:0 !important; }
    #lb-loc   { font-size:10px; font-weight:700; letter-spacing:0.2em; text-transform:uppercase; color:var(--rose); margin-bottom:4px; }
    #lb-title { font-family:'Playfair Display',serif; font-size:1.2rem; color:var(--text); }
    #lb-date  { font-size:11px; color:var(--text-2); margin-top:4px; }

    /* ‚ú® Description in lightbox */
    #lb-desc {
      margin-top: 12px;
      font-size: 12.5px;
      line-height: 1.75;
      color: var(--text-2);
      font-style: italic;
      background: var(--rose-dim);
      border-radius: 10px;
      padding: 10px 14px;
      text-align: left;
      display: none;
    }

    #zoom-badge { position:absolute; top:14px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.45); color:#fff; font-size:11px; font-weight:600; padding:3px 12px; border-radius:99px; opacity:0; pointer-events:none; transition:opacity 0.3s; }
    #zoom-badge.show { opacity:1; }
    .lb-btn { position:absolute; width:46px; height:46px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:var(--surface); border:1px solid var(--border); cursor:pointer; transition:all 0.2s; color:var(--text); box-shadow:0 4px 14px var(--shadow); z-index:10; }
    .lb-btn:hover { background:var(--rose); color:#fff; border-color:var(--rose); }
    #lb-close { top:18px; right:18px; }
    #lb-prev  { left:14px; top:50%; transform:translateY(-50%); }
    #lb-next  { right:14px; top:50%; transform:translateY(-50%); }
    @media(max-width:500px){ #lb-prev{left:6px;} #lb-next{right:6px;} }
  </style>
</head>
<body>
  <div class="blob blob-a"></div>
  <div class="blob blob-b"></div>

  <!-- LOCK SCREEN -->
  <div id="overlay">
    <button id="theme-pill-lock" onclick="toggleNight()"><span id="pill-icon-lock">‚òÄÔ∏è</span></button>
    <div id="lock-card">
      <div class="lock-icon-wrap">
        <i data-lucide="lock" style="color:var(--rose);width:24px;height:24px;"></i>
      </div>
      <h2 class="lock-heading">Our Private World</h2>
      <p class="lock-hint">Hint: First Meeting</p>
      <p class="lock-format">(D D M M)</p>
      <div class="dots-row">
        <div class="dot" id="d0"></div><div class="dot" id="d1"></div>
        <div class="dot" id="d2"></div><div class="dot" id="d3"></div>
      </div>
      <div class="numpad">
        <button class="key" onclick="kp(1)">1</button>
        <button class="key" onclick="kp(2)">2</button>
        <button class="key" onclick="kp(3)">3</button>
        <button class="key" onclick="kp(4)">4</button>
        <button class="key" onclick="kp(5)">5</button>
        <button class="key" onclick="kp(6)">6</button>
        <button class="key" onclick="kp(7)">7</button>
        <button class="key" onclick="kp(8)">8</button>
        <button class="key" onclick="kp(9)">9</button>
        <div class="key empty"></div>
        <button class="key" onclick="kp(0)">0</button>
        <button class="key del" onclick="kd()">
          <i data-lucide="delete" style="width:20px;height:20px;"></i>
        </button>
      </div>
      <p id="err">Incorrect date, try again ‚ù§Ô∏è</p>
    </div>
  </div>

  <!-- MAIN GALLERY -->
  <div id="main">
    <header class="reveal">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;">
        <div class="badge" style="margin-bottom:0;">Unlocked Memory Box</div>
        <div id="side-actions" style="margin-bottom:0;">
          <button class="side-btn" id="btn-theme" onclick="toggleNight()">
            <span id="pill-icon-gallery">‚òÄÔ∏è</span>
          </button>
          <button class="side-btn" id="btn-fullscreen" onclick="toggleFullscreen()">
            <i data-lucide="maximize-2" style="width:16px;height:16px;"></i>
          </button>
        </div>
      </div>
      <h1 class="hero-title">Beautiful <em>moments</em>.</h1>
    </header>

    <div id="filter-bar" class="reveal">
      <div class="filter-group">
        <span class="filter-group-label"><i data-lucide="calendar" style="width:12px;height:12px;"></i> Year</span>
        <div class="f-wrap">
          <select class="f-select" id="year-sel" onchange="applyFilters()"><option value="">All Years</option></select>
          <svg class="f-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
        </div>
      </div>
      <div class="filter-divider"></div>
      <div class="filter-group">
        <span class="filter-group-label"><i data-lucide="map-pin" style="width:12px;height:12px;"></i> Place</span>
        <div class="f-wrap">
          <select class="f-select" id="loc-sel" onchange="applyFilters()"><option value="">Everywhere</option></select>
          <svg class="f-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
        </div>
      </div>
      <div class="filter-divider"></div>
      <span id="filter-count"></span>
      <button id="filter-reset" onclick="resetFilters()"><i data-lucide="x" style="width:12px;height:12px;"></i> Reset</button>
    </div>

    <div id="gallery">
      <div id="gallery-loader"><div class="loader-spin"></div>Loading memories‚Ä¶</div>
      <div id="no-results">No photos match this filter ‚ù§Ô∏è</div>
    </div>

    <footer><h3>Forever &amp; Always</h3><p>¬© 2025 ‚Äì 2026</p></footer>
  </div>

  <!-- LIGHTBOX -->
  <div id="lightbox">
    <button class="lb-btn" id="lb-close" onclick="closeLB()"><i data-lucide="x" style="width:18px;height:18px;"></i></button>
    <div id="lb-zoom-area">
      <div id="zoom-badge">100%</div>
      <img id="lb-img" alt="">
    </div>
    <div id="lb-caption">
      <p id="lb-loc"></p>
      <h3 id="lb-title"></h3>
      <p id="lb-date"></p>
      <p id="lb-desc"></p>
    </div>
    <button class="lb-btn" id="lb-prev" onclick="shiftImg(-1)"><i data-lucide="arrow-left" style="width:18px;height:18px;"></i></button>
    <button class="lb-btn" id="lb-next" onclick="shiftImg(1)"><i data-lucide="arrow-right" style="width:18px;height:18px;"></i></button>
  </div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 ‚ú¶  PHOTOS ‚Äî ADD YOUR ENTRIES HERE
 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 FIELDS:
   title    ‚Äì Caption shown on card & lightbox
   date     ‚Äì e.g. "05 Dec 2025"
   location ‚Äì City / place name (used in filter)
   desc     ‚Äì ‚ú® SHORT MEMORY NOTE (optional)
              A few lines about what happened ‚Äî a funny
              moment, how you felt, a little story.
              Shows on the card (clamped to 3 lines with
              a "read more" toggle) and in full inside
              the lightbox with a soft pink background.
   images   ‚Äì Array of image URLs
 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

const BASE = "https://raw.githubusercontent.com/Duveyji/livephotos/main/Pics/";

const PHOTOS = [
  // ‚îÄ‚îÄ DEC 2025 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    title:    "The First Meeting",
    date:     "05 Dec 2025",
    location: "Nalasopara",
    desc:     "The day everything started. We were both so nervous but it felt so natural the moment we sat down together. I kept sneaking glances and hoping you wouldn't notice. You did. ‚ù§Ô∏è",
    images:   [ BASE + "1.jpg" ]
  },
  {
    title:    "The Jivdani Temple",
    date:     "24 Dec 2025",
    location: "Virar",
    desc:     "At the temple ‚Äî we climbed all those steps and you held my hand on the way down. The view from the top was stunning, but I wasn't really looking at the view.",
    images:   [ BASE + "2.jpg" ]
  },

  // ‚îÄ‚îÄ JAN 2026 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  {
    title:    "Dwarkadhish Mandir ‚Äì Virar",
    date:     "23 Jan 2026",
    location: "Virar",
    desc:     "We prayed together for the first time. There's something so quiet and beautiful about sharing that with someone.",
    images:   [ BASE + "15.jpg", BASE + "15a.jpg", BASE + "15b.jpg" ]
  },
  {
    title:    "The Jivdani Temple",
    date:     "23 Jan 2026",
    location: "Virar",
    desc:     "Back again ‚Äî this place already feels like ours.",
    images:   [ BASE + "15c.jpg" ]
  },
  {
    title:    "Domino's Pizza in Virar",
    date:     "24 Jan 2026",
    location: "Virar",
    desc:     "We argued over toppings for ten minutes and ordered the same thing we always do anyway. Laughed the whole time.",
    images:   [ BASE + "16.jpg", BASE + "16a.jpg" ]
  },
  {
    title:    "Miraj Dattani - Movie",
    date:     "26 Jan 2026",
    location: "Vasai",
    desc:     "You covered your eyes during the scary parts and then pretended you weren't scared. I didn't say anything. üòÑ",
    images:   [ BASE + "11.jpeg", BASE + "11a.jpeg" ]
  },
  {
    title:    "The Jivdani Temple",
    date:     "29 Jan 2026",
    location: "Virar",
    desc:     "Third visit and it never gets old. We took the best photos here ‚Äî you were glowing.",
    images:   [ BASE + "17.jpeg", BASE + "17a.jpg", BASE + "17b.jpg" ]
  },
  {
    title:    "Hall Ticket",
    date:     "14 Feb 2026",
    location: "Palghar",
    desc:     "Valentine's Day, and we spent it sorting exam papers. Peak romance. Still the best Valentine's I've had. üíå",
    images:   [ BASE + "18.jpg", BASE + "18a.jpg" ]
  },
  {
    title:    "Deep Education Campus",
    date:     "18 Feb 2026",
    location: "Boisar",
    desc:     "Walking through campus together before exams. The world felt huge and I felt calm because you were there.",
    images:   [ BASE + "19.jpg", BASE + "19a.jpg" ]
  },
  {
    title:    "No Touch Day",
    date:     "20 Feb 2026",
    location: "Boisar",
    desc:     "We made up a silly rule and broke it about four times. Worth it every single time.",
    images:   [ BASE + "20.jpg", BASE + "20a.jpg", BASE + "20b.jpg", BASE + "20c.jpg" ]
  },
  {
    title:    "Last Day of Exam",
    date:     "21 Feb 2026",
    location: "Boisar",
    desc:     "Finally done. We walked out and just stood in the sun for a moment. Relief, happiness, and us ‚Äî a perfect combination.",
    images:   [ BASE + "21.jpg", BASE + "21a.jpg" ]
  },

  // ‚îÄ‚îÄ ADD NEW ENTRIES BELOW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // {
  //   title:    "Sunset Walk",
  //   date:     "01 Mar 2026",
  //   location: "Virar",
  //   desc:     "Write your little memory note here‚Ä¶",
  //   images:   [ BASE + "22.jpg" ]
  // },
];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 ‚ú¶  PASSCODE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const PASS_HASH = "78c72f67941a420cd4e5ee9fdabcaeaba6d72f16160915085f9802220fd83799";
async function sha256(s) {
  const b = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(s));
  return [...new Uint8Array(b)].map(x => x.toString(16).padStart(2,"0")).join("");
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê THEME ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let night = false;
function toggleNight() {
  night = !night;
  document.documentElement.toggleAttribute("data-night", night);
  const icon = night ? "üåô" : "‚òÄÔ∏è";
  document.getElementById("pill-icon-lock").textContent    = icon;
  document.getElementById("pill-icon-gallery").textContent = icon;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FULLSCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function toggleFullscreen() {
  if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{});
  else document.exitFullscreen().catch(()=>{});
}
document.addEventListener("fullscreenchange", () => {
  const isFs = !!document.fullscreenElement;
  document.body.classList.toggle("is-fullscreen", isFs);
  const btn = document.getElementById("btn-fullscreen");
  btn.querySelector("i").replaceWith((() => {
    const el = document.createElement("i");
    el.setAttribute("data-lucide", isFs ? "minimize-2" : "maximize-2");
    el.style.cssText = "width:16px;height:16px;";
    return el;
  })());
  lucide.createIcons({ nodes: [btn] });
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let pin = "";
function kp(n) { if(pin.length>=4) return; pin+=n; syncDots(); if(pin.length===4) setTimeout(verify,320); }
function kd()  { pin=pin.slice(0,-1); syncDots(); }
function syncDots() { for(let i=0;i<4;i++) document.getElementById("d"+i).classList.toggle("on",i<pin.length); }
async function verify() {
  if (await sha256(pin) === PASS_HASH) {
    document.getElementById("overlay").classList.add("bye");
    setTimeout(() => {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("side-actions").classList.add("visible");
    }, 700);
  } else {
    const e=document.getElementById("err"); e.style.opacity="1";
    document.getElementById("lock-card").animate([
      {transform:"translateX(0)"},{transform:"translateX(-9px)"},
      {transform:"translateX(9px)"},{transform:"translateX(-6px)"},
      {transform:"translateX(0)"}
    ],{duration:380,easing:"ease-out"});
    setTimeout(()=>{e.style.opacity="0";pin="";syncDots();},1400);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUTO-GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function autoGroup(photos) {
  const map = new Map();
  photos.forEach(p => {
    const key = (p.title||"") + "|" + (p.date||"") + "|" + (p.location||"");
    if (map.has(key)) { map.get(key).images.push(...p.images); }
    else { map.set(key, { title: p.title, date: p.date, location: p.location, desc: p.desc||"", images: [...p.images] }); }
  });
  return [...map.values()];
}
function sortPhotos(arr) {
  return [...arr].sort((a,b) => {
    if (!a.date&&!b.date) return 0; if (!a.date) return 1; if (!b.date) return -1;
    return new Date(a.date)-new Date(b.date);
  });
}
const yearOf = d => d ? d.trim().split(" ").pop() : "";

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FILTERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function buildFilters(photos) {
  const years = [...new Set(photos.map(p=>yearOf(p.date)).filter(Boolean))].sort();
  const locs  = [...new Set(photos.map(p=>p.location).filter(Boolean))].sort();
  const ys=document.getElementById("year-sel"), ls=document.getElementById("loc-sel");
  while(ys.options.length>1) ys.remove(1);
  while(ls.options.length>1) ls.remove(1);
  years.forEach(y=>{ const o=document.createElement("option"); o.value=y; o.textContent=y; ys.appendChild(o); });
  locs.forEach(l =>{  const o=document.createElement("option"); o.value=l; o.textContent=l; ls.appendChild(o); });
}
function applyFilters() {
  const y=document.getElementById("year-sel").value, l=document.getElementById("loc-sel").value;
  document.getElementById("year-sel").classList.toggle("active",!!y);
  document.getElementById("loc-sel").classList.toggle("active",!!l);
  document.getElementById("filter-reset").classList.toggle("visible",!!(y||l));
  let visible=0,total=0;
  document.querySelectorAll(".g-item").forEach(el=>{
    total++;
    const p=el._photo, show=(!y||yearOf(p.date)===y)&&(!l||p.location===l);
    el.classList.toggle("filtered-out",!show); if(show) visible++;
  });
  document.querySelectorAll(".timeline-header").forEach(hdr=>{
    let el=hdr.nextElementSibling,anyVis=false;
    while(el&&!el.classList.contains("timeline-header")){
      if(el.classList.contains("g-item")&&!el.classList.contains("filtered-out")) anyVis=true;
      el=el.nextElementSibling;
    }
    hdr.classList.toggle("filtered-out",!anyVis);
  });
  const countEl=document.getElementById("filter-count");
  countEl.innerHTML=(y||l)?`<b>${visible}</b> of ${total} memories`:"";
  document.getElementById("no-results").classList.toggle("show",visible===0);
}
function resetFilters() {
  document.getElementById("year-sel").value=""; document.getElementById("loc-sel").value="";
  document.getElementById("year-sel").classList.remove("active"); document.getElementById("loc-sel").classList.remove("active");
  document.getElementById("filter-reset").classList.remove("visible"); document.getElementById("filter-count").innerHTML="";
  document.querySelectorAll(".g-item,.timeline-header").forEach(el=>{ el.classList.remove("filtered-out"); el.classList.add("active"); });
  document.getElementById("no-results").classList.remove("show");
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BUILD GALLERY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const layout=[
  [8,"62%","0px"],[4,"130%","60px"],
  [5,"120%","0px"],[7,"60%","-50px"],
  [6,"100%","0px"],[6,"75%","30px"],
  [7,"65%","0px"],[5,"125%","-40px"]
];
let PHOTOS_SORTED=[];

function buildGallery() {
  PHOTOS_SORTED = sortPhotos(autoGroup(PHOTOS));
  buildFilters(PHOTOS_SORTED);
  const galleryEl=document.getElementById("gallery");
  document.getElementById("gallery-loader")?.remove();
  let layoutIdx=0, lastDateLocKey="";

  PHOTOS_SORTED.forEach((p,gi)=>{
    const dateLocKey=(p.date||"undated")+"|"+(p.location||"");
    if(dateLocKey!==lastDateLocKey){
      lastDateLocKey=dateLocKey;
      const hdr=document.createElement("div");
      hdr.className="timeline-header reveal"; hdr._photo=p;
      hdr.innerHTML=`<div class="tl-dot"></div><div class="tl-info"><div class="tl-date">${p.date||"Unknown Date"}</div><div class="tl-loc">${p.location||""}</div></div><div class="tl-line"></div>`;
      galleryEl.insertBefore(hdr,document.getElementById("no-results"));
    }

    const [cols,pt,mt]=layout[layoutIdx++%layout.length];
    const el=document.createElement("div");
    el.className="reveal g-item"; el._photo=p;
    el.style.cssText=`grid-column:span ${cols};margin-top:${mt};`;

    const count=p.images.length;
    const badge=count>1?`<div class="img-count-badge">üì∑ ${count}</div>`:"";
    const dots=count>1?`<div class="g-strip">${p.images.map((_,i)=>`<div class="g-dot${i===0?" cur":""}"></div>`).join("")}</div>`:"";
    const navs=count>1
      ?`<button class="g-nav prev" onclick="cardPrev(event,${gi})"><i data-lucide="chevron-left" style="width:14px;height:14px;"></i></button>
        <button class="g-nav next" onclick="cardNext(event,${gi})"><i data-lucide="chevron-right" style="width:14px;height:14px;"></i></button>`:"";

    // ‚ú® desc block
    const descHtml = p.desc
      ? `<p class="g-desc" id="desc-${gi}">${p.desc}</p>
         <button class="g-desc-toggle" id="dtog-${gi}" onclick="toggleDesc(event,${gi})">Read more ‚Üì</button>`
      : "";

    el.innerHTML=`
      <div class="g-img-wrap" onclick="cardClick(event,${gi})">
        <div class="g-img-inner" style="padding-top:${pt};" data-gi="${gi}" data-cur="0">
          <img class="g-img" src="${p.images[0]}" loading="lazy" alt="${p.title}">
          <div class="g-hover-layer"><span>${p.location||""}</span></div>
          ${badge}${dots}${navs}
        </div>
      </div>
      <div class="g-caption">
        <div class="g-title">${p.title}</div>
        ${p.location?`<div class="g-loc">${p.location}</div>`:""}
        ${p.date?`<div class="g-date">${p.date}${count>1?" &nbsp;¬∑&nbsp; "+count+" photos":""}</div>`:""}
        ${descHtml}
      </div>`;
    galleryEl.insertBefore(el,document.getElementById("no-results"));
  });

  // Show "read more" only if text is actually overflowing
  requestAnimationFrame(() => {
    PHOTOS_SORTED.forEach((_,gi) => {
      const d=document.getElementById(`desc-${gi}`);
      const t=document.getElementById(`dtog-${gi}`);
      if (d && t && d.scrollHeight > d.clientHeight + 4) t.style.display="inline-block";
    });
  });

  document.querySelectorAll(".reveal:not(.active)").forEach(el=>io.observe(el));
  lucide.createIcons();
}

function toggleDesc(e, gi) {
  e.stopPropagation();
  const d=document.getElementById(`desc-${gi}`), t=document.getElementById(`dtog-${gi}`);
  const expanded=d.classList.toggle("expanded");
  t.textContent = expanded ? "Show less ‚Üë" : "Read more ‚Üì";
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CARD NAV ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function getInner(gi){ return document.querySelector(`.g-img-inner[data-gi="${gi}"]`); }
function setCardImg(gi,idx){ const inner=getInner(gi); if(!inner) return; inner.dataset.cur=idx; inner.querySelector(".g-img").src=PHOTOS_SORTED[gi].images[idx]; inner.querySelectorAll(".g-dot").forEach((d,i)=>d.classList.toggle("cur",i===idx)); }
function cardPrev(e,gi){ e.stopPropagation(); const inner=getInner(gi); const cur=+inner.dataset.cur,len=PHOTOS_SORTED[gi].images.length; setCardImg(gi,(cur-1+len)%len); }
function cardNext(e,gi){ e.stopPropagation(); const inner=getInner(gi); const cur=+inner.dataset.cur,len=PHOTOS_SORTED[gi].images.length; setCardImg(gi,(cur+1)%len); }
function cardClick(e,gi){ const inner=getInner(gi); openLB(gi,+inner.dataset.cur); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LIGHTBOX + PINCH/PAN/SWIPE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let lbGroup=0,lbImgIdx=0;
const lb=document.getElementById("lightbox"),lbImgEl=document.getElementById("lb-img"),lbCap=document.getElementById("lb-caption"),zoomBadge=document.getElementById("zoom-badge");
let scale=1,minScale=1,maxScale=5,tx=0,ty=0,startTx=0,startTy=0,pinching=false,initDist=0,initScale=1,dragging=false,dragStartX=0,dragStartY=0,swipeStartX=0,lastTap=0,badgeTimer=null;

function applyTransform(animated){ lbImgEl.style.transition=animated?"transform 0.25s ease,opacity 0.45s,border-radius 0.3s":"opacity 0.45s,border-radius 0.3s"; if(animated) setTimeout(()=>lbImgEl.style.transition="opacity 0.45s,border-radius 0.3s",280); lbImgEl.style.transform=`translate(${tx}px,${ty}px) scale(${scale})`; lbImgEl.style.borderRadius=scale>1.5?"6px":"18px"; lbCap.classList.toggle("hidden-cap",scale>1.1); zoomBadge.textContent=Math.round(scale*100)+"%"; clearTimeout(badgeTimer); zoomBadge.classList.add("show"); badgeTimer=setTimeout(()=>zoomBadge.classList.remove("show"),1200); }
function clamp(){ if(!lbImgEl.naturalWidth) return; const mx=Math.max(0,(lbImgEl.offsetWidth*scale-lb.offsetWidth)/2),my=Math.max(0,(lbImgEl.offsetHeight*scale-lb.offsetHeight)/2); tx=Math.max(-mx,Math.min(mx,tx)); ty=Math.max(-my,Math.min(my,ty)); }
function resetZoom(a){scale=1;tx=0;ty=0;applyTransform(a);}

const za=document.getElementById("lb-zoom-area");
za.addEventListener("touchstart",e=>{ if(e.touches.length===2){pinching=true;dragging=false;initDist=Math.hypot(e.touches[1].clientX-e.touches[0].clientX,e.touches[1].clientY-e.touches[0].clientY);initScale=scale;startTx=tx;startTy=ty;}else if(e.touches.length===1){const now=Date.now();if(now-lastTap<280){if(scale>1.05){resetZoom(true);}else{scale=2.5;tx=-(e.touches[0].clientX-lb.offsetWidth/2)*(scale-1)/scale;ty=-(e.touches[0].clientY-lb.offsetHeight/2)*(scale-1)/scale;clamp();applyTransform(true);}lastTap=0;return;}lastTap=now;dragging=true;pinching=false;dragStartX=e.touches[0].clientX;dragStartY=e.touches[0].clientY;swipeStartX=e.touches[0].clientX;startTx=tx;startTy=ty;}},{passive:true});
za.addEventListener("touchmove",e=>{ if(e.touches.length===2&&pinching){e.preventDefault();scale=Math.min(maxScale,Math.max(minScale,initScale*Math.hypot(e.touches[1].clientX-e.touches[0].clientX,e.touches[1].clientY-e.touches[0].clientY)/initDist));tx=startTx;ty=startTy;clamp();applyTransform(false);}else if(e.touches.length===1&&dragging&&scale>1.05){e.preventDefault();tx=startTx+(e.touches[0].clientX-dragStartX);ty=startTy+(e.touches[0].clientY-dragStartY);clamp();applyTransform(false);}},{passive:false});
za.addEventListener("touchend",e=>{ if(pinching&&e.touches.length<2){pinching=false;if(scale<1.08)resetZoom(true);}if(dragging&&scale<=1.05){const dx=(e.changedTouches[0]?.clientX??swipeStartX)-swipeStartX;if(Math.abs(dx)>50)shiftImg(dx<0?1:-1);}dragging=false;},{passive:true});
za.addEventListener("wheel",e=>{ e.preventDefault();scale=Math.min(maxScale,Math.max(minScale,scale*(e.deltaY<0?1.12:0.88)));clamp();applyTransform(false);},{passive:false});

function openLB(gi,ii){lbGroup=gi;lbImgIdx=ii;resetZoom(false);lb.classList.add("open");loadLBImage();}
function loadLBImage(){
  const p=PHOTOS_SORTED[lbGroup],url=p.images[lbImgIdx];
  lbImgEl.classList.remove("on");lbCap.classList.remove("on");lbImgEl.style.transform="";
  lbImgEl.onload=()=>{lbImgEl.classList.add("on");lbCap.classList.add("on");};
  lbImgEl.src=url;
  document.getElementById("lb-loc").textContent=p.location||"";
  document.getElementById("lb-title").textContent=p.title;
  const tot=p.images.length;
  document.getElementById("lb-date").textContent=tot>1?`${p.date}  ¬∑  ${lbImgIdx+1} / ${tot}`:(p.date||"");
  // ‚ú® description in lightbox
  const lbDescEl=document.getElementById("lb-desc");
  if(p.desc){ lbDescEl.textContent=p.desc; lbDescEl.style.display="block"; }
  else { lbDescEl.style.display="none"; }
}
function closeLB(){ lbImgEl.classList.remove("on");lbCap.classList.remove("on");setTimeout(()=>{lb.classList.remove("open");resetZoom(false);},350); }
function shiftImg(d){ resetZoom(false);const next=lbImgIdx+d;if(next>=0&&next<PHOTOS_SORTED[lbGroup].images.length){lbImgIdx=next;}else{lbGroup=(lbGroup+d+PHOTOS_SORTED.length)%PHOTOS_SORTED.length;lbImgIdx=d>0?0:PHOTOS_SORTED[lbGroup].images.length-1;}lbImgEl.classList.remove("on");lbCap.classList.remove("on");setTimeout(loadLBImage,150); }
lb.addEventListener("click",e=>{if(e.target===lb)closeLB();});
document.addEventListener("keydown",e=>{ if(!lb.classList.contains("open"))return; if(e.key==="Escape")closeLB(); if(e.key==="ArrowLeft")shiftImg(-1); if(e.key==="ArrowRight")shiftImg(1); if(e.key==="0")resetZoom(true); });

/* ‚îÄ‚îÄ INIT ‚îÄ‚îÄ */
lucide.createIcons();
const io=new IntersectionObserver(entries=>entries.forEach(e=>{if(e.isIntersecting)e.target.classList.add("active");}),{threshold:0.08});
document.querySelectorAll(".reveal").forEach(el=>io.observe(el));
buildGallery();
</script>
</body>
</html>
